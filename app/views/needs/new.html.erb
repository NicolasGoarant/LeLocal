<% content_for :title, "LeLocal - Indiquer mes besoins en locaux" %>

<% content_for :head do %>
<style>
/* (styles inchangés, condensés) */
.container{max-width:1200px;margin:0 auto;padding:0 20px;width:100%}
.page-header{background-image:linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.6)),url('https://images.unsplash.com/photo-1542744095-fcf48d80b0fd?auto=format&fit=crop&w=1350&q=80');background-size:cover;background-position:center;padding:120px 0 80px;color:#fff;text-align:center}
.page-header h1{font-size:clamp(2rem,5vw,2.8rem);margin-bottom:15px;font-weight:700}
.page-header p{font-size:clamp(1rem,2.5vw,1.2rem);max-width:700px;margin:0 auto}
.main-content{padding:80px 0}
.form-container{max-width:900px;margin:0 auto;background:#fff;border-radius:20px;padding:50px;box-shadow:0 15px 35px rgba(0,0,0,.1)}
.form-intro{text-align:center;margin-bottom:40px}
.form-intro h2{font-size:28px;color:#333;margin-bottom:15px;font-weight:700}
.form-intro p{color:#666;font-size:16px;line-height:1.6}
.form-section{margin-bottom:40px;padding-bottom:30px;border-bottom:1px solid #eee}
.form-section:last-child{border-bottom:none}
.form-section-title{font-size:20px;color:#333;margin-bottom:25px;font-weight:600;display:flex;align-items:center;gap:12px}
.form-section-title i{color:#4CAF50;font-size:24px}
.form-group{margin-bottom:25px}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:25px}
.form-group label{display:block;font-weight:600;margin-bottom:8px;color:#333}
.required::after{content:' *';color:#e74c3c}
.input-field{width:100%;padding:15px;border:2px solid #e0e0e0;border-radius:8px;font-size:16px;transition:all .3s;background:#fff}
.input-field:focus{border-color:#4CAF50;outline:none;box-shadow:0 0 0 3px rgba(76,175,80,.1)}
.textarea-field{min-height:120px;resize:vertical}
.help-text{display:block;margin-top:5px;font-size:14px;color:#666;font-style:italic}
.checkbox-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px;margin-top:15px}
.checkbox-item{display:flex;align-items:center;gap:12px;padding:12px 15px;border:1px solid #e0e0e0;border-radius:8px;transition:all .3s}
.checkbox-item:hover{background:#f8f9fa;border-color:#4CAF50}
.btn-submit{display:block;width:100%;padding:18px;background:#4CAF50;color:#fff;border:none;border-radius:30px;font-size:18px;font-weight:600;cursor:pointer;transition:all .3s;margin-top:30px}
.btn-submit:hover{background:#388E3C;transform:translateY(-2px);box-shadow:0 5px 15px rgba(76,175,80,.3)}
.alert{padding:15px 20px;border-radius:8px;margin-bottom:30px}
.alert-danger{background:#ffeaea;border:1px solid #f5c6cb;color:#721c24}
@media(max-width:768px){.form-container{padding:30px 25px;margin:0 15px}.form-row{grid-template-columns:1fr}}
</style>
<% end %>

<div class="page-header">
  <div class="container">
    <h1>Indiquer mes besoins en locaux</h1>
    <p>Décrivez vos besoins. Seuls la <b>ville</b>, le <b>jour</b>, l’<b>email</b> et le <b>téléphone</b> sont obligatoires.</p>
  </div>
</div>

<div class="main-content">
  <div class="container">
    <div class="form-container">
      <div class="form-intro">
        <h2>Partagez vos besoins</h2>
        <p>Tout le reste est facultatif, ajoutez ce que vous voulez : nous vous recontactons rapidement.</p>
      </div>

      <% if @need && @need.errors&.any? %>
        <div class="alert alert-danger">
          <h4><%= pluralize(@need.errors.count, "erreur") %> ont empêché l'envoi :</h4>
          <ul>
            <% @need.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <%= form_with(model: @need, scope: :need, url: needs_path, local: true, html: { class: 'needs-form' }) do |form| %>

        <!-- Vos coordonnées (OBLIGATOIRE) -->
        <div class="form-section">
          <h3 class="form-section-title"><i class="fas fa-user"></i> Vos coordonnées</h3>
          <div class="form-row">
            <div class="form-group">
              <%= form.label :contact_email, "Email", class: "required" %>
              <%= form.email_field :contact_email, class: "input-field", placeholder: "votre@email.com", required: true %>
            </div>
            <div class="form-group">
              <%= form.label :contact_phone, "Téléphone", class: "required" %>
              <%= form.telephone_field :contact_phone, class: "input-field", placeholder: "06 12 34 56 78", required: true %>
            </div>
          </div>
        </div>

        <!-- Localisation (VILLE OBLIGATOIRE) -->
        <div class="form-section">
          <h3 class="form-section-title"><i class="fas fa-map-marker-alt"></i> Localisation</h3>
          <div class="form-row">
            <div class="form-group">
              <%= form.label :city, "Ville souhaitée", class: "required" %>
              <%= form.text_field :city, class: "input-field", placeholder: "Ex: Rennes, Lyon…", required: true %>
            </div>
            <div class="form-group">
              <%= form.label :postal_code, "Code postal" %>
              <%= form.text_field :postal_code, class: "input-field", placeholder: "Ex: 35000" %>
            </div>
          </div>
          <div class="form-group">
            <%= form.label :address, "Adresse / quartier (optionnel)" %>
            <%= form.text_field :address, class: "input-field", placeholder: "Quartier, zone, etc." %>
          </div>
        </div>

        <!-- Date (OBLIGATOIRE) -->
        <div class="form-section">
          <h3 class="form-section-title"><i class="fas fa-calendar-alt"></i> Date</h3>
          <div class="form-row">
            <div class="form-group">
              <%= form.label :date_needed, "Jour souhaité", class: "required" %>
              <%= form.date_field :date_needed, class: "input-field", required: true %>
            </div>
            <div class="form-group">
              <%= form.label :duration, "Durée (h) (optionnel)" %>
              <%= form.number_field :duration, class: "input-field", min: 0, step: 0.5, placeholder: "Ex: 4" %>
            </div>
          </div>
        </div>

        <!-- Détails optionnels -->
        <div class="form-section">
          <h3 class="form-section-title"><i class="fas fa-info-circle"></i> Détails optionnels</h3>
          <div class="form-group">
            <%= form.label :title, "Titre de la demande" %>
            <%= form.text_field :title, class: "input-field", placeholder: "Ex: Atelier créatif, réunion d'équipe..." %>
          </div>
          <div class="form-group">
            <%= form.label :description, "Description (optionnelle)" %>
            <%= form.text_area :description, class: "input-field textarea-field", placeholder: "Ambiance, contraintes, etc." %>
          </div>
          <div class="form-row">
            <div class="form-group">
              <%= form.label :capacity, "Nb. de personnes (optionnel)" %>
              <%= form.number_field :capacity, class: "input-field", min: 1, placeholder: "Ex: 20" %>
            </div>
            <div class="form-group">
              <%= form.label :budget, "Budget max (optionnel)" %>
              <%= form.number_field :budget, class: "input-field", min: 0, step: 10, placeholder: "Ex: 600" %>
            </div>
          </div>
          <div class="form-group">
            <%= form.label :equipment_needs, "Équipements souhaités (optionnel)" %>
            <div class="checkbox-grid">
              <% [
                ['WiFi', 'wifi'], ['Projecteur/Écran', 'projector'], ['Système audio', 'sound'],
                ['Espace traiteur', 'catering'], ['Parking', 'parking'], ['Accessibilité PMR', 'accessibility']
              ].each do |label, value| %>
                <div class="checkbox-item">
                  <%= check_box_tag "need[equipment_needs][]", value, false, id: "need_equipment_#{value}" %>
                  <%= label_tag "need_equipment_#{value}", label %>
                </div>
              <% end %>
            </div>
          </div>
        </div>

        <%= form.submit "Envoyer ma demande", class: "btn-submit" %>
      <% end %>
    </div>
  </div>
</div>
